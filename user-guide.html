<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RiskDesk | User Guide</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    
    <style>
        body { background-color: #0f172a; color: #e2e8f0; font-family: system-ui, -apple-system, sans-serif; }
        .prose-slate { color: #94a3b8; }
        .prose-h3 { color: #f8fafc; font-weight: 700; margin-top: 2rem; margin-bottom: 1rem; font-size: 1.25rem; }
        .prose-p { margin-bottom: 1rem; line-height: 1.7; }
        .highlight-box { background: rgba(30, 41, 59, 0.5); border-left: 4px solid #3b82f6; padding: 1.5rem; margin: 1.5rem 0; border-radius: 0 0.5rem 0.5rem 0; }
        .danger-box { background: rgba(127, 29, 29, 0.1); border-left: 4px solid #ef4444; padding: 1.5rem; margin: 1.5rem 0; border-radius: 0 0.5rem 0.5rem 0; }
        .formula-box { background: #1e293b; padding: 1rem; border-radius: 0.5rem; font-family: monospace; color: #fbbf24; overflow-x: auto; margin: 1rem 0; font-size: 0.85rem; }
        .toc-link:hover { color: #60a5fa; padding-left: 4px; }
        .toc-link { transition: all 0.2s; display: block; padding: 4px 0; color: #94a3b8; font-size: 0.9rem; }
        
        /* Custom Table Styles */
        .guide-table th { text-transform: uppercase; font-size: 0.75rem; letter-spacing: 0.05em; padding: 0.75rem; background: #1e293b; color: #e2e8f0; border-bottom: 1px solid #334155; }
        .guide-table td { padding: 0.75rem; border-bottom: 1px solid #334155; font-size: 0.875rem; vertical-align: top; }
        .guide-table tr:last-child td { border-bottom: none; }
    </style>
</head>
<body class="antialiased">

    <nav class="fixed w-full z-50 bg-slate-900/95 backdrop-blur border-b border-slate-800">
        <div class="max-w-7xl mx-auto px-6 h-16 flex items-center justify-between">
            <div class="flex items-center gap-2 group">
                <i data-lucide="book" class="w-5 h-5 text-blue-500"></i>
                <span class="font-bold text-lg tracking-tight">RISK<span class="text-slate-400">DESK</span> <span class="text-xs bg-slate-800 px-2 py-1 rounded text-blue-400 ml-2 border border-slate-700">DOCS v10</span></span>
            </div>
            
            <a href="https://riskdesk.io" class="flex items-center gap-2 text-sm font-medium text-slate-400 hover:text-white transition-colors group">
                <span class="hidden md:inline">Back to Main Site</span>
                <i data-lucide="arrow-right" class="w-4 h-4 group-hover:translate-x-1 transition-transform"></i>
            </a>
        </div>
    </nav>

    <div class="pt-24 pb-20 max-w-7xl mx-auto px-6 flex flex-col md:flex-row gap-12">
        
        <aside class="w-full md:w-64 flex-shrink-0 hidden md:block">
            <div class="sticky top-24">
                <h4 class="text-xs font-bold text-slate-500 uppercase tracking-wider mb-4">Contents</h4>
                <nav class="space-y-1">
                    <a href="#philosophy" class="toc-link">Core Philosophy</a>
                    <a href="#setup" class="toc-link">1. Initial Setup</a>
                    <a href="#live-data" class="toc-link">2. Live Data & Prices</a>
                    <a href="#calculator" class="toc-link">3. Calculator Engine</a>
                    <a href="#metrics" class="toc-link">4. Risk Metrics</a>
                    <a href="#logs" class="toc-link">5. Logs & Views</a>
                    <a href="#management" class="toc-link">6. Trade Management</a>
                    <a href="#statistics" class="toc-link">7. Stats & Insights</a>
                    <a href="#journal" class="toc-link">8. The Journal</a>
                    <a href="#cloud" class="toc-link text-blue-400 font-bold">9. Google Cloud Sync</a>
                    <a href="#privacy" class="toc-link">10. Privacy & Sharing</a>
                    <a href="#glossary" class="toc-link mt-4 text-xs opacity-50">Disclaimer</a>
                </nav>
            </div>
        </aside>

        <main class="flex-1 max-w-3xl">
            
            <section id="header" class="mb-16 border-b border-slate-800 pb-10">
                <h1 class="text-4xl font-extrabold text-white mb-4">The Professional Guide</h1>
                <p class="text-lg text-slate-400 leading-relaxed">Master your risk, manage your psychology, and understand the mathematics behind RiskDesk v10.</p>
            </section>

            <section id="philosophy" class="mb-20">
                <div class="flex items-center gap-3 mb-6">
                    <div class="p-2 bg-blue-500/10 rounded-lg"><i data-lucide="book-open" class="w-6 h-6 text-blue-400"></i></div>
                    <h2 class="text-2xl font-bold text-white">Core Philosophy</h2>
                </div>
                <div class="prose-slate">
                    <p class="prose-p">RiskDesk is not just a calculator; it is a discipline engine. It is built on the premise that <strong>Capital Preservation</strong> is the primary job of a trader.</p>
                    <p class="prose-p">RiskDesk delivers <strong>dynamic, risk-first, multi-account position sizing</strong> paired with seamless trade logging. It combines <strong>comprehensive statistical analysis</strong> with a powerful journaling engine to help you trade with precision.</p>
                </div>
            </section>

            <section id="setup" class="mb-20">
                <div class="flex items-center gap-3 mb-6">
                    <div class="p-2 bg-purple-500/10 rounded-lg"><i data-lucide="settings" class="w-6 h-6 text-purple-400"></i></div>
                    <h2 class="text-2xl font-bold text-white">1. Initial Setup</h2>
                </div>
                <div class="prose-slate">
                    <h3 class="prose-h3">Account Configuration</h3>
                    <p class="prose-p">Go to <strong>Settings</strong> to define your trading environment. You can add multiple accounts (e.g., "Main Swing", "Day Trading").</p>
                    <ul class="list-disc pl-5 space-y-2 mb-4 text-sm">
                        <li><strong>Master Account:</strong> You must select one account as "Master" using the radio button. This account's size is used as the denominator for "Equity Contribution (EC%)" calculations.</li>
                        <li><strong>Base Currency:</strong> Set your Global Base Currency (e.g., GBP). All portfolio stats will be normalized to this currency via the built-in FX API.</li>
                    </ul>

                    <h3 class="prose-h3">The Fund Manager</h3>
                    <p class="prose-p">Tap the <i data-lucide="wallet" class="w-3 h-3 inline text-emerald-400"></i> <strong>Wallet Icon</strong> on any account in the Settings or Calculator view to open the Fund Manager.</p>
                    <ul class="list-disc pl-5 space-y-2 mb-4 text-sm">
                        <li><strong>Deposits & Withdrawals:</strong> Log capital injections or withdrawals. These are tracked separately from trading P&L so they don't skew your performance stats.</li>
                        <li><strong>Monthly Auto-Deposit:</strong> Configure a recurring contribution (e.g., $500 on the 1st of every month). The app will automatically add this to your balance when you open it, allowing you to simulate salary injections and track realistic account growth.</li>
                    </ul>

                    <h3 class="prose-h3">Data Management</h3>
                    <p class="prose-p text-sm">RiskDesk offers two modes of data storage:</p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div class="bg-slate-800 p-4 rounded-lg border border-slate-700">
                            <strong class="text-white text-sm block mb-1">Local Mode (Default)</strong>
                            <p class="text-xs text-slate-400">Data lives in your browser's local storage. Private and fast, but data does not sync between devices. Clearing browser cache deletes data.</p>
                        </div>
                        <div class="bg-slate-800 p-4 rounded-lg border border-slate-700">
                            <strong class="text-white text-sm block mb-1">Cloud Sync</strong>
                            <p class="text-xs text-slate-400">Syncs data to your own Google Drive using a secure script. Private and allows trading across Phone/Laptop. See <a href="#cloud" class="text-blue-400 hover:underline">Section 9</a>.</p>
                        </div>
                    </div>

                    <h3 class="prose-h3">Stats Configuration: Partials Impact</h3>
                    <p class="prose-p">Found in Settings, this toggle controls how your statistics are calculated.</p>
                    
                    <div class="overflow-hidden rounded-lg border border-slate-700 my-4">
                        <table class="w-full text-left guide-table">
                            <thead>
                                <tr>
                                    <th>Feature</th>
                                    <th class="text-emerald-400">OFF (Strict Mode)</th>
                                    <th class="text-blue-400">ON (Dynamic Mode)</th>
                                </tr>
                            </thead>
                            <tbody class="bg-slate-800">
                                <tr>
                                    <td class="font-bold text-slate-400">Math</td>
                                    <td>Calculates averages using ONLY fully closed trades.</td>
                                    <td>Includes Realized P&L from active trades (Partials).</td>
                                </tr>
                                <tr>
                                    <td class="font-bold text-slate-400">Use Case</td>
                                    <td>Conservative. "What is my proven, banked edge?"</td>
                                    <td>Cashflow. "How is my account growing right now?"</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <section id="live-data" class="mb-20">
                <div class="flex items-center gap-3 mb-6">
                    <div class="p-2 bg-amber-500/10 rounded-lg"><i data-lucide="zap" class="w-6 h-6 text-amber-400"></i></div>
                    <h2 class="text-2xl font-bold text-white">2. Live Data & Prices</h2>
                </div>
                <div class="prose-slate">
                    <p class="prose-p">RiskDesk connects to APIs to keep your risk data accurate without requiring a monthly subscription.</p>

                    <h3 class="prose-h3">Live Price Integration (Finnhub)</h3>
                    <p class="prose-p">To enable the <strong class="text-white"><i data-lucide="refresh-cw" class="w-3 h-3 inline"></i> Fetch Prices</strong> button in the top Risk Bar, you need a free API key.</p>
                    <ol class="list-decimal pl-5 space-y-2 mb-4 text-sm text-slate-300">
                        <li>Go to <a href="https://finnhub.io" target="_blank" class="text-blue-400 hover:underline">finnhub.io</a> and register for a free account.</li>
                        <li>Copy your default API Key from their dashboard.</li>
                        <li>Paste it into <strong>Settings > App Preferences > Finnhub API Key</strong>.</li>
                    </ol>
                    <p class="text-xs text-slate-500 border-l-2 border-amber-500 pl-3 py-1">
                        <strong>Note for UK/Intl Stocks:</strong> The API uses standard exchange suffixes. For London stocks, ensure your tickers end in <code>.L</code> (e.g., <code>VOD.L</code>). For Toronto, use <code>.TO</code>.
                    </p>
                </div>
            </section>

            <section id="calculator" class="mb-20">
                <div class="flex items-center gap-3 mb-6">
                    <div class="p-2 bg-emerald-500/10 rounded-lg"><i data-lucide="calculator" class="w-6 h-6 text-emerald-400"></i></div>
                    <h2 class="text-2xl font-bold text-white">3. Calculator Engine</h2>
                </div>
                
                <div class="prose-slate">
                    <p class="prose-p">The calculator determines your position size based on your risk tolerance. It offers three distinct mathematical models:</p>

                    <div class="grid md:grid-cols-3 gap-4 my-6">
                        <div class="bg-slate-800 p-4 rounded-xl border border-slate-700">
                            <h4 class="text-white font-bold mb-2 text-sm">Equity Risk %</h4>
                            <p class="text-xs text-slate-400 mb-2">"Lose max 1.0% of account."</p>
                            <div class="text-[10px] font-mono text-emerald-400">Shares = (Account * Risk%) / (Entry - Stop)</div>
                        </div>
                        <div class="bg-slate-800 p-4 rounded-xl border border-slate-700">
                            <h4 class="text-white font-bold mb-2 text-sm">Position Size %</h4>
                            <p class="text-xs text-slate-400 mb-2">"Invest 10% of capital."</p>
                            <div class="text-[10px] font-mono text-blue-400">Shares = (Account * Alloc%) / Entry</div>
                        </div>
                        <div class="bg-slate-800 p-4 rounded-xl border border-slate-700">
                            <h4 class="text-white font-bold mb-2 text-sm">Cash Risk $</h4>
                            <p class="text-xs text-slate-400 mb-2">"Lose exactly $100."</p>
                            <div class="text-[10px] font-mono text-amber-400">Shares = CashRisk / (Entry - Stop)</div>
                        </div>
                    </div>

                    <h3 class="prose-h3">Key Features</h3>
                    <ul class="list-disc pl-5 space-y-2 mb-4 text-sm">
                        <li><strong>Trade Currency:</strong> Ensure you select the currency of the asset you are trading (e.g. USD for Apple). If it differs from your Base Currency (e.g. GBP), the FX API will handle the conversion to ensure your risk sizing is accurate in your home currency.</li>
                        <li><strong>Staggered Stops:</strong> You are not limited to a single stop price. Toggle "Staggered" to set multiple weighted stop levels. The system calculates a weighted average stop to determine true risk per share.</li>
                        <li><strong>Chart Capture:</strong> Paste a chart image directly from your clipboard (Ctrl+V) into the "Paste Zone" to save the setup chart permanently with the trade.</li>
                    </ul>
                </div>
            </section>

            <section id="metrics" class="mb-20">
                <div class="flex items-center gap-3 mb-6">
                    <div class="p-2 bg-slate-800 rounded-lg border border-slate-700"><i data-lucide="activity" class="w-6 h-6 text-emerald-400"></i></div>
                    <h2 class="text-2xl font-bold text-white">4. Risk Metrics</h2>
                </div>
                
                <div class="prose-slate">
                    <p class="prose-p text-sm">The <strong>Live Risk Bar</strong> monitors your "Progressive Exposure". It answers: "Have I earned the right to take more risk?"</p>

                    <dl class="space-y-6 mt-6">
                        <div class="bg-slate-800/50 p-4 rounded-xl border border-slate-700">
                            <dt class="font-bold text-emerald-400 flex justify-between items-center">
                                <span>NER (Net Exposure Risk)</span>
                                <span class="text-[10px] uppercase tracking-wider text-slate-500 font-bold">Principal Protection</span>
                            </dt>
                            <dd class="text-sm text-slate-300 mt-2">
                                The percentage of your account currently at risk that is <strong>NOT financed</strong> by banked profits. If NER is 0%, your open risk is fully covered by realized gains—you are trading on "House Money".
                                <div class="formula-box">NER = ( Σ(Open Risk) - Σ(Banked Profit) ) / Account Size</div>
                                <p class="text-xs text-slate-500 italic">*Floored at 0%. If Banked Profit > Open Risk, NER is 0.</p>
                            </dd>
                        </div>

                        <div class="bg-slate-800/50 p-4 rounded-xl border border-slate-700">
                            <dt class="font-bold text-blue-400 flex justify-between items-center">
                                <span>NEP (Net Exposure Profit)</span>
                                <span class="text-[10px] uppercase tracking-wider text-slate-500 font-bold">Traction</span>
                            </dt>
                            <dd class="text-sm text-slate-300 mt-2">
                                The Unrealized (Floating) Profit of your <strong>risk-bearing</strong> trades. It tells you if your *new* exposure is working immediately.
                                <div class="formula-box">NEP = Floating P&L of Unfinanced Trades / Account Size</div>
                            </dd>
                        </div>
                        
                        <div class="bg-slate-800/50 p-4 rounded-xl border border-slate-700">
                            <dt class="font-bold text-blue-400 flex justify-between">
                                <span>Delta</span>
                                <span class="text-xs opacity-50 font-mono text-white">Your Net Traction</span>
                            </dt>
                            <dd class="text-sm text-slate-300 mt-2">
                                The relationship between your Traction (NEP) and your Risk (NER).
                            </dd>
                        </div>

                        <div class="bg-slate-800/50 p-4 rounded-xl border border-slate-700">
                            <dt class="font-bold text-slate-200 flex justify-between items-center">
                                <span>OER (Open Exposure Risk)</span>
                                <span class="text-[10px] uppercase tracking-wider text-slate-500 font-bold">Total Heat</span>
                            </dt>
                            <dd class="text-sm text-slate-300 mt-2">
                                Your gross total risk based on <strong>current active stops</strong>. If you move stops to Breakeven, OER drops to 0%.
                                <div class="formula-box">OER = Σ( (Entry - CurrentStop) * Qty ) / Account Size</div>
                            </dd>
                        </div>

                        <div class="bg-slate-800/50 p-4 rounded-xl border border-slate-700">
                            <dt class="font-bold text-amber-400 flex justify-between items-center">
                                <span>Secured (Net Financing)</span>
                                <span class="text-[10px] uppercase tracking-wider text-slate-500 font-bold">The Buffer</span>
                            </dt>
                            <dd class="text-sm text-slate-300 mt-2">
                                The amount of Banked Profit that exceeds your Principal Risk. If positive, you cannot lose principal capital even if all stops hit.
                                <div class="formula-box">Secured = (Total Banked Profit - Total Open Risk) / Account Size</div>
                            </dd>
                        </div>
                    </dl>
                </div>
            </section>
            
            <section id="logs" class="mb-20">
                <div class="flex items-center gap-3 mb-6">
                    <div class="p-2 bg-amber-500/10 rounded-lg"><i data-lucide="list" class="w-6 h-6 text-amber-400"></i></div>
                    <h2 class="text-2xl font-bold text-white">5. Logs & Views</h2>
                </div>
                
                <div class="prose-slate">
                    <h3 class="prose-h3">Viewing Modes (Responsive)</h3>
                    <p class="prose-p">RiskDesk changes the data it displays based on your device orientation to prevent information overload.</p>
                    
                    <div class="grid md:grid-cols-2 gap-6 my-6">
                        <div class="bg-slate-800 p-4 rounded-xl border border-slate-700">
                            <h4 class="text-white font-bold mb-2 uppercase text-xs border-b border-slate-700 pb-1">Portrait Mode (Mobile)</h4>
                            <p class="text-xs text-slate-400 mb-2">Optimized for quick scanning.</p>
                            <ul class="text-xs text-slate-500 list-disc pl-4 space-y-1">
                                <li>Date & Time</li>
                                <li>Ticker & Direction</li>
                                <li>Risk % & R-Multiple</li>
                                <li>P&L / Status Badge</li>
                            </ul>
                        </div>
                        <div class="bg-slate-800 p-4 rounded-xl border border-slate-700">
                            <h4 class="text-white font-bold mb-2 uppercase text-xs border-b border-slate-700 pb-1">Landscape Mode (Pro View)</h4>
                            <p class="text-xs text-slate-400 mb-2">Rotate your phone to reveal the professional data tape.</p>
                            <ul class="text-xs text-slate-500 list-disc pl-4 space-y-1">
                                <li><strong>Position Size:</strong> Total value of the position in trade currency.</li>
                                <li><strong>Live Price:</strong> Real-time current price (if enabled).</li>
                                <li><strong>Qty:</strong> Original vs Current shares held.</li>
                                <li><strong>EC%:</strong> Equity Contribution % (Impact on Net Worth).</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <section id="management" class="mb-20">
                <div class="flex items-center gap-3 mb-6">
                    <div class="p-2 bg-rose-500/10 rounded-lg"><i data-lucide="layers" class="w-6 h-6 text-rose-400"></i></div>
                    <h2 class="text-2xl font-bold text-white">6. Trade Management</h2>
                </div>
                
                <div class="prose-slate">
                    <p class="prose-p">Tap any log entry to open the Management Console.</p>

                    <ul class="space-y-4 mb-6">
                        <li>
                            <strong class="text-white">Stop Adjustments:</strong> Update your "Current Stop" as the trade moves in your favor. This automatically updates your <strong>Open Heat</strong> metric on the dashboard.
                        </li>
                        <li>
                            <strong class="text-white">Partial Exits:</strong> Record partial sells by specifying Price, Quantity, and Date. The system calculates the realized P&L for that specific chunk and reduces your NER.
                        </li>
                        <li>
                            <strong class="text-white">Chart Gallery:</strong> Stores all images associated with the trade (Entry Chart, Exit Chart, and any Journal updates). Tap any image to view it full screen.
                        </li>
                    </ul>

                    <h3 class="prose-h3">Dynamic De-Risking</h3>
                    <div class="highlight-box">
                        <strong class="text-white block mb-2">The "Risk Free" Formula</strong>
                        <p class="text-sm">RiskDesk uses a dynamic equation to tell you exactly where to take partial profits to eliminate risk. Unlike static rules (e.g., "Sell 1/3 at 2R"), RiskDesk adapts to your <strong>Adjusted Stop</strong>.</p>
                        <div class="formula-box">Target = Entry + ( (CurrentNER / SharesToSell) - CurrentRiskPerShare )</div>
                    </div>
                </div>
            </section>

            <section id="statistics" class="mb-20">
                <div class="flex items-center gap-3 mb-6">
                    <div class="p-2 bg-cyan-500/10 rounded-lg"><i data-lucide="bar-chart-2" class="w-6 h-6 text-cyan-400"></i></div>
                    <h2 class="text-2xl font-bold text-white">7. Stats & Insights</h2>
                </div>

                <div class="prose-slate">
                    <h3 class="prose-h3">Smart Filters (Time Slicing)</h3>
                    <p class="prose-p">The Stats engine now supports powerful time-slicing. You can filter your entire dashboard by:</p>
                    <ul class="flex flex-wrap gap-2 text-xs font-mono text-slate-300 mb-6">
                        <li class="bg-slate-800 px-2 py-1 rounded border border-slate-700">Last 20 Trades</li>
                        <li class="bg-slate-800 px-2 py-1 rounded border border-slate-700">This Week</li>
                        <li class="bg-slate-800 px-2 py-1 rounded border border-slate-700">This Month</li>
                        <li class="bg-slate-800 px-2 py-1 rounded border border-slate-700">YTD</li>
                        <li class="bg-slate-800 px-2 py-1 rounded border border-slate-700">Custom Range</li>
                    </ul>

                    <h3 class="prose-h3">Core Metrics</h3>
                    <div class="grid md:grid-cols-2 gap-4 mb-6">
                        <div class="bg-slate-800 p-3 rounded border border-slate-700">
                            <strong class="text-white block text-sm">Financial Health</strong>
                            <p class="text-xs text-slate-400">Win Rate, Profit Factor, Expectancy.</p>
                        </div>
                        <div class="bg-slate-800 p-3 rounded border border-slate-700">
                            <strong class="text-white block text-sm">Strategy Edge</strong>
                            <p class="text-xs text-slate-400">Performance breakdown by Strategy tag.</p>
                        </div>
                    </div>

                    <h3 class="prose-h3">Consistency Heatmap</h3>
                    <p class="prose-p">This GitHub-style grid visualizes your trading frequency and quality. Use the toggle buttons to switch modes:</p>
                    <ul class="list-disc pl-5 space-y-2 mb-4 text-sm">
                        <li><strong>By Entry:</strong> Highlights days where you <em>initiated</em> winning trades. Measures Origination Quality.</li>
                        <li><strong>By Exit:</strong> Highlights days where you <em>banked</em> profit. Measures Cashflow.</li>
                        <li><strong>By Discipline:</strong> Green = Rules Followed. Red = Rules Broken. Measures Behavioral Consistency.</li>
                    </ul>

                    <h3 class="prose-h3">Key Formulas</h3>
                    <div class="space-y-4">
                        <div>
                            <strong class="text-slate-200 block">Expectancy</strong>
                            <div class="formula-box">Expectancy = (Win% × AvgWinR) - (Loss% × AvgLossR)</div>
                        </div>
                        <div>
                            <strong class="text-slate-200 block">Profit Factor</strong>
                            <div class="formula-box">PF = (Gross Profit $) / (Gross Loss $)</div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="journal" class="mb-20">
                <div class="flex items-center gap-3 mb-6">
                    <div class="p-2 bg-pink-500/10 rounded-lg"><i data-lucide="book-open" class="w-6 h-6 text-pink-400"></i></div>
                    <h2 class="text-2xl font-bold text-white">8. The Journal</h2>
                </div>
                
                <div class="prose-slate">
                    <p class="prose-p">The Journal tab is your daily accountability partner.</p>
                    
                    <ul class="list-disc pl-5 space-y-3">
                        <li><strong>Golden Rules:</strong> Define your rules in the "Philosophy" tab. They persist daily.</li>
                        <li><strong>Automated Feed:</strong> The Journal automatically pulls in every trade entry and exit for the selected date, creating an instant timeline of your day.</li>
                        <li><strong>Discipline Tracking:</strong> You must answer: <em>"Did you follow your rules today?"</em>
                            <ul class="list-disc pl-5 mt-2 text-sm text-slate-400">
                                <li><strong>YES:</strong> Marks the heatmap Green.</li>
                                <li><strong>NO:</strong> Marks the heatmap Red. A checklist of your rules appears, forcing you to check off exactly <em>which</em> rules you broke.</li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </section>

            <section id="cloud" class="mb-20">
                <div class="flex items-center gap-3 mb-6">
                    <div class="p-2 bg-slate-800 rounded-lg border border-slate-700"><i data-lucide="cloud" class="w-6 h-6 text-blue-400"></i></div>
                    <h2 class="text-2xl font-bold text-white">9. Google Cloud Sync</h2>
                </div>
                
                <div class="prose-slate">
                    <p class="prose-p text-sm">RiskDesk can sync data between devices using your personal Google Drive as the database. You own the infrastructure.</p>

                    <div class="bg-slate-800 p-6 rounded-xl border border-slate-700 mb-6">
                        <h4 class="text-white font-bold mb-4">Setup Instructions</h4>
                        <ol class="list-decimal pl-5 space-y-3 text-sm text-slate-300">
                            <li>Create a new <strong>Google Sheet</strong> at <a href="https://sheets.google.com" target="_blank" class="text-blue-400 underline">sheets.google.com</a>.</li>
                            <li>Go to <strong>Extensions > Apps Script</strong>.</li>
                            <li>Paste the RiskDesk Sync Script:</li>
                            
                            <div class="my-4 bg-slate-950 border border-slate-800 rounded-lg overflow-hidden">
                                <div class="flex justify-between items-center px-4 py-2 bg-slate-900 border-b border-slate-800">
                                    <span class="text-xs text-slate-500 font-mono">Apps Script Code</span>
                                    <button onclick="copyToClipboard()" class="text-xs bg-blue-600 hover:bg-blue-500 text-white px-3 py-1 rounded transition-colors">Copy</button>
                                </div>
                                <pre class="p-4 text-xs font-mono text-slate-400 overflow-x-auto"><code id="appScript">function doPost(e) {
  try {
    var data = e.postData.contents;
    var fileName = "riskdesk_data.json";
    var files = DriveApp.getFilesByName(fileName);

    if (files.hasNext()) {
      files.next().setContent(data);
    } else {
      DriveApp.createFile(fileName, data, MimeType.PLAIN_TEXT);
    }

    return ContentService.createTextOutput("Saved").setMimeType(ContentService.MimeType.TEXT);
  } catch (err) {
    return ContentService.createTextOutput("Error: " + err.toString());
  }
}

function doGet(e) {
  try {
    var fileName = "riskdesk_data.json";
    var files = DriveApp.getFilesByName(fileName);

    if (files.hasNext()) {
      var data = files.next().getBlob().getDataAsString();
      return ContentService.createTextOutput(data).setMimeType(ContentService.MimeType.JSON);
    } else {
      return ContentService.createTextOutput("{}").setMimeType(ContentService.MimeType.JSON);
    }
  } catch (err) {
    return ContentService.createTextOutput("Error: " + err.toString());
  }
}</code></pre>
                            </div>

                            <li>Click <strong>Deploy > New Deployment</strong>.</li>
                            <li>Select type: <strong>Web App</strong>.</li>
                            <li>Set "Execute as: <strong>Me</strong>".</li>
                            <li>Set "Who has access: <strong>Anyone</strong>". (Crucial).</li>
                            <li>Click <strong>Deploy</strong>.</li>
                            <li>Authorize permissions when prompted (Select Account > Advanced > Go to (unsafe) > Allow).</li>
                            <li>Copy the <strong>Web App URL</strong> and paste it into RiskDesk Settings.</li>
                        </ol>
                    </div>

                    <div class="bg-blue-900/10 border-l-4 border-blue-500 p-6 my-8 rounded-r">
                        <h4 class="text-blue-400 font-bold text-sm uppercase mb-4 flex items-center gap-2">
                            <i data-lucide="lock" class="w-4 h-4"></i> Security: Is this Safe?
                        </h4>
                        
                        <p class="text-sm text-slate-300 mb-4 leading-relaxed">
                            <strong>Yes.</strong> You might see a Google warning saying <em>"This app isn't verified"</em> or <em>"Go to (unsafe)"</em>. This is expected because <strong>YOU are the developer</strong>.
                        </p>

                        <div class="space-y-4">
                            <div>
                                <strong class="text-white text-xs uppercase tracking-wide block mb-1">1. Why "Unverified"?</strong>
                                <p class="text-sm text-slate-400">Google flags any private script as "unverified" until you pay to have it professionally audited. Since you created this for personal use, you are simply authorizing your own code.</p>
                            </div>
                            
                            <div>
                                <strong class="text-white text-xs uppercase tracking-wide block mb-1">2. Why "Access to Anyone"?</strong>
                                <p class="text-sm text-slate-400">This does <strong>not</strong> make your data public. "Anyone" means "Anyone with the <strong>secret URL</strong>" (which is only you). This setting is required technically so your browser can send data to Google without being blocked by security firewalls (CORS).</p>
                            </div>

                            <div>
                                <strong class="text-white text-xs uppercase tracking-wide block mb-1">3. Can it delete my files?</strong>
                                <p class="text-sm text-slate-400">The permission asks to "See, edit, create and delete files" because that is the standard Google permission group. However, the script you pasted explicitly looks for <strong>only one file</strong>: <code>riskdesk_data.json</code>. It does not touch anything else in your Drive.</p>
                            </div>
                        </div>
                    </div>

                    <h3 class="prose-h3 border-b border-slate-800 pb-4 mb-6">Cloud Setup Scenarios</h3>

                    <div class="bg-slate-800 p-6 rounded-xl border border-slate-700 mb-6">
                        <h4 class="text-blue-400 font-bold text-lg mb-2">Scenario A: Brand New User (No Data)</h4>
                        <p class="text-sm text-slate-400 italic mb-4">Follow this if you are just starting and have no trade history logged yet.</p>
                        
                        <ol class="list-decimal pl-5 space-y-3 text-sm text-slate-300">
                            <li><strong class="text-white">Paste</strong> the Web App URL into RiskDesk Settings on your first device.</li>
                            <li><strong class="text-white">Click</strong> Sync.</li>
                            <li><strong class="text-white">Repeat</strong> on any other devices (Laptop, Tablet, etc.).</li>
                            <li><strong class="text-white">You are ready!</strong> Any trade you log on one device will now appear on the others.</li>
                        </ol>
                    </div>

                    <div class="bg-slate-800 p-6 rounded-xl border border-slate-700 mb-8">
                        <h4 class="text-blue-400 font-bold text-lg mb-4">Scenario B: Existing User (Migrating Data)</h4>

                        <div class="danger-box my-4">
                            <h5 class="text-red-400 font-bold uppercase text-xs mb-2">⚠️ Critical Warning</h5>
                            <p class="text-xs text-red-300/80 leading-relaxed">
                                You must establish the "Master" copy of your data first. Failure to follow this order could result in data overwrites.
                            </p>
                        </div>

                        <ol class="list-decimal pl-5 space-y-3 text-sm text-slate-300">
                            <li>Open RiskDesk on the <strong>device that holds your current data</strong> (e.g., your Phone).</li>
                            <li><strong class="text-white">Paste</strong> the Web App URL into Settings.</li>
                            <li><strong class="text-white">Click Sync.</strong> (This uploads your data to create the "Master File" in Google Drive).</li>
                            <li><strong class="text-white">Only after step 3</strong>, open RiskDesk on your other devices (e.g., Laptop).</li>
                            <li>Paste the URL and <strong class="text-white">Click Sync</strong>. (This will download the data from the cloud).</li>
                        </ol>
                    </div>

                    <h3 class="prose-h3">Important Caveats</h3>
                    <ul class="list-disc pl-5 space-y-3 text-sm text-slate-400">
                        <li><strong>The "Open Tab" Rule:</strong> If you leave RiskDesk open on your Laptop while you trade on your Phone, the Laptop won't know about the Phone's trades. <strong>Always refresh</strong> or click Sync when switching devices.</li>
                        <li><strong>Images are Local:</strong> To keep sync fast and free, chart screenshots are stored on your specific device, not in Google Drive.</li>
                        <li><strong>Offline Mode:</strong> You can trade offline. When you return online, click Sync to push your changes to the cloud.</li>
                    </ul>
                </div>
            </section>

            <section id="privacy" class="mb-20">
                <div class="flex items-center gap-3 mb-6">
                    <div class="p-2 bg-slate-800 rounded-lg border border-slate-700"><i data-lucide="shield" class="w-6 h-6 text-slate-300"></i></div>
                    <h2 class="text-2xl font-bold text-white">10. Privacy & Sharing</h2>
                </div>
                
                <div class="prose-slate">
                    <h3 class="prose-h3">Data Sovereignty</h3>
                    <ul class="space-y-3 text-sm text-slate-400 mb-8">
                        <li><strong>You Own Your Data:</strong> RiskDesk is a "Serverless" application. We do not have a database. We cannot see your trades, account balance, or strategies.</li>
                        <li><strong>Storage:</strong> Your data lives in your browser's Local Storage (on your actual device) or in <strong>YOUR</strong> personal Google Drive (if Cloud Sync is active).</li>
                        <li><strong>No Recovery:</strong> Because we don't have your data, we cannot recover it if you delete it. Maintain regular backups.</li>
                    </ul>

                    <h3 class="prose-h3">Sharing Features</h3>
                    <ul class="space-y-4">
                        <li class="flex gap-3">
                            <i data-lucide="eye" class="w-6 h-6 text-slate-500 shrink-0"></i>
                            <div>
                                <strong class="text-white">Privacy Mode</strong>
                                <p class="text-sm text-slate-400">Tap the Eye icon in the top header. This blurs all dollar/currency values across the Logs, Stats, and Journal. Ideal for working in public or sharing screens.</p>
                            </div>
                        </li>
                        <li class="flex gap-3">
                            <i data-lucide="share-2" class="w-6 h-6 text-slate-500 shrink-0"></i>
                            <div>
                                <strong class="text-white">Social Sharing</strong>
                                <p class="text-sm text-slate-400">Tap the Camera icon on any Log row, Stats card, or Journal page to generate a clean, branded image formatted for X (Twitter) and Discord.</p>
                            </div>
                        </li>
                    </ul>
                </div>
            </section>

            <section id="glossary" class="mb-24 pt-10 border-t border-slate-800">
                <div class="danger-box mt-10 text-center text-xs text-red-300">
                    <p class="mb-2"><strong>Disclaimer:</strong> This tool is for educational and journaling purposes only. It is not financial advice. Trading involves significant risk.</p>
                    <p><strong>Data Warning:</strong> Live prices are provided by third-party services (e.g., Finnhub) and may be delayed or inaccurate. Never execute trades based solely on these prices; always verify with your broker.</p>
                </div>
            </section>

        </main>
    </div>

    <footer class="bg-slate-900 border-t border-slate-800 py-12 text-center">
        <p class="text-slate-500 text-sm">© RiskDesk v10. Built for Traders.</p>
    </footer>

    <script>
        lucide.createIcons();
        function copyToClipboard() {
            var copyText = document.getElementById("appScript").innerText;
            navigator.clipboard.writeText(copyText).then(() => {
                alert("Script copied to clipboard!");
            });
        }
    </script>
</body>
</html>
